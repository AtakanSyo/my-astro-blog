---
/**
 * Props:
 *  - id:   unique DOM id for the canvas element (string)
 *  - slug: folder name under src/interactive (e.g., "gpu-demo")
 *  - height: CSS height for the canvas block (default "500px")
 */
const { id, slug, height = "500px" } = Astro.props;
import entryUrl from "./simcanvas.entry.ts?url";  // <â€” add this line

---

<div data-simcanvas data-id={id} data-slug={slug}></div>

<style>
  .sim-wrap { width: 100%; }
  .sim-controls { display: flex; gap: .5rem; align-items: center; margin: .5rem 0; }
  .sim-stage { opacity: 0; transition: opacity 240ms ease; }
  .sim-stage.is-visible { opacity: 1; }
  .sim-canvas { width: 100%; display: block; block-size: var(--h, 500px); }
</style>

<div class="sim-wrap" style={`--h:${height};`}>
  <div class="sim-controls">
    <button id={`pause-${id}`} type="button">Play</button>
  </div>

  <div id={`stage-${id}`} class="sim-stage is-visible">
    <canvas id={id} class="sim-canvas"></canvas>
  </div>
</div>

<script type="module" client:load is:inline define:vars={{ id, slug }}>
  // Import the client module via an absolute /src path so Vite can transform it
  import { probe } from '/src/components/simcanvas.client.ts';
  probe(id, slug);
</script>