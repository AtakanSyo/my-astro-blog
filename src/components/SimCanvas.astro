---
const id = `sim-${Math.random().toString(36).slice(2,8)}`;
const { slug, aspect = "16/9", showPause = true } = Astro.props;
---

<div class="sim-stage centered_flex" style={`aspect-ratio: ${aspect};`}>
  <canvas id={id}></canvas>
  {showPause && <button id={`pause-${id}`} class="pill sim-controls-inline" type="button">Play</button>}
</div>

<script type="module" client:load define:vars={{ id, slug }}>
  (async () => {
    const canvas = document.getElementById(id);
    const pauseBtn = document.getElementById(`pause-${id}`);
    if (!canvas) return;

    // âœ… dynamic import with a variable path
    const mod = await import(`/interactive/${slug}/loader.js`);
    (mod.default || mod)(canvas, pauseBtn);
  })().catch(err => console.error('SimCanvas load failed:', err));
</script>